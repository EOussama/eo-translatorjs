"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(e){var t=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(_classCallCheck(this,n),!e||"object"!==_typeof(e)||Array.isArray(e))throw new Error("[EO TranslatorJS] Invalid dictionary object");if("string"!=typeof t)throw new Error("[EO TranslatorJS] Invalid language key, expected “string” by recieved “".concat(_typeof(t),"”"));this.dictionary=e||{},this.language=t||("object"===("undefined"==typeof document?"undefined":_typeof(document))?document.documentElement.lang:"en")||"en"}return _createClass(n,[{key:"dictionary",set:function(e){if(!e||"object"!==_typeof(e)||Array.isArray(e))throw new Error("[EO TranslatorJS] Invalid dictionary object");this._dictionary=e},get:function(){return this._dictionary}},{key:"language",set:function(e){if("string"!=typeof e)throw new Error("[EO TranslatorJS] Invalid language key, expected “string” by recieved “".concat(_typeof(e),"”"));this._language=e},get:function(){return this._language}},{key:"languages",get:function(){return this.dictionary?Object.keys(this.dictionary):[]}}]),_createClass(n,[{key:"translate",value:function(){var n,r,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=t.lang||this.language,i=t.fallback||e,o=t.params||{},l=e.split(".").filter(function(e){return 0<e.length});if(this.isValidLanguage(a)){var u=this.dictionary.hasOwnProperty(this.language);return u&&(u=1<l.length?function(e,t,n){var r=e[t],a=!0,i=!1,o=void 0;try{for(var l,u=n[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=l.value;if(!(r=r[c]||void 0))break}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return r}(this.dictionary,a,l):this.dictionary[a][e]),u?(n=u,r=o,Object.keys(r).forEach(function(e){var t=new RegExp("{".concat(e,"}"),"g");n=n.replace(t,r[e])}),n):i}return i}},{key:"translateElement",value:function(e,t){if(e){var n=t||this.language,r=e.attributes["eo-translator"].value||e.textContent||e.innerText||e.innerHTML,a=(e.attributes["eo-translator-fallback"]||{value:r}).value,i=JSON.parse((e.attributes["eo-translator-params"]||{value:"{}"}).value)||{};e.textContent=this.translate(r,{lang:n,fallback:a,params:i})}}},{key:"translateDOM",value:function(e,t){var n=this,r=t||this.language,a=e||"object"===("undefined"==typeof document?"undefined":_typeof(document))?document:null;a&&a.querySelectorAll("[eo-translator]").forEach(function(e){return n.translateElement(e,r)})}},{key:"add",value:function(e,t,n){var r=t.split(".").filter(function(e){return 0<e.length}),a=r.pop();this.dictionary.hasOwnProperty(e)||(this.dictionary[e]={});var i=this.dictionary[e];if(0<r.length)for(var o=Object.entries(r),l=0;l<o.length;l++){var u=_slicedToArray(o[l],2),c=u[0],s=u[1];if(!(i=i[s]||(i[s]={})))break;parseInt(c)===r.length-1&&(i[a]=n)}else i[t]=n}},{key:"remove",value:function(e,t){var n=t.split(".").filter(function(e){return 0<e.length}),r=n.pop();if(this.dictionary.hasOwnProperty(e)){var a=this.dictionary[e];if(0<n.length)for(var i=Object.entries(n),o=0;o<i.length;o++){var l=_slicedToArray(i[o],2),u=l[0];if(!(a=a[l[1]]))break;parseInt(u)===n.length-1&&delete a[r]}else delete a[t]}}},{key:"isValidLanguage",value:function(e){return this.dictionary.hasOwnProperty(e)}}]),n}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t}):window.EOTranslator=t}("undefined"!=typeof window&&window);